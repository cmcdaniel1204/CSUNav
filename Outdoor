<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Leaflet</title>
    <link rel="stylesheet" href="./leaflet/leaflet.css" />
    <link rel="stylesheet" href="./leaflet/plugins/leaflet-routing-machine.css" />
    <style>
        .leaflet-control-container .leaflet-routing-container-hide {
            display: none;
        }
    </style>
</head>

<body>

    <!-- Page Content -->
    <div class="w3-padding-large" id="main">
        <!-- Header/Home -->
        <header class="w3-container w3-padding-18 w3-center w3-blue" id="home">
            <h1 class="w3-jumbo"><span class="w3-hide-small">CSUNav</span></h1>
            <p>Interactive Campus Navigation</p>
        </header>

        <div id="map" class="map" style="width: 1000px; height: 500px; margin-left: auto; margin-right: auto; "></div>
        <script src="./leaflet/leaflet.js"></script>
        <script src="./leaflet/plugins/leaflet-routing-machine.js"></script>
        <script src="../../leaflet-indoor.js"></script>
        <script type="text/javascript">

            var data = [
                { "loc": [35.350365, -119.105509], "title": "Administration" },
                { "loc": [35.350689, -119.105023], "title": "Administration East" },
                { "loc": [35.350411, -119.105997], "title": "Administration West" },
                { "loc": [35.353623, -119.102521], "title": "Amphitheatre" },
                { "loc": [35.348696, -119.104989], "title": "Business Development Center A" },
                { "loc": [35.348696, -119.104755], "title": "Business Development Center B" },
                { "loc": [35.348372, -119.104884], "title": "Business Development Center C" },
                { "loc": [35.348453, -119.105281], "title": "Business Development Center D" },
                { "loc": [35.348805, -119.105270], "title": "Business Development Center E" },
                { "loc": [35.349772, -119.105088], "title": "Central Plant Operations" },
                { "loc": [35.349053, -119.107572], "title": "Child Care" },
                { "loc": [35.351186, -119.105428], "title": "Classroom Building" },
                { "loc": [35.352188, -119.105431], "title": "Dore Theater" },
                { "loc": [35.350394, -119.103605], "title": "Dorothy Donahoe Hall" },
                { "loc": [35.350208, -119.104479], "title": "Education Building" },
                { "loc": [35.347950, -119.104696], "title": "Engineering Modulars" },
                { "loc": [35.345029, -119.103575], "title": "Facilities" },
                { "loc": [35.351908, -119.106834], "title": "Humanities Complex" },
                { "loc": [35.347541, -119.102631], "title": "Icardo Center" },
                { "loc": [35.348283, -119.101773], "title": "J. Antonio Sports Center" },
                { "loc": [35.347887, -119.101496], "title": "J.R. Hillman Aquatic Center" },
                { "loc": [35.350617, -119.101311], "title": "Modular East 3" },
                { "loc": [35.349101, -119.107158], "title": "Modular West" },
                { "loc": [35.351881, -119.105831], "title": "Music Building" },
                { "loc": [35.353192, -119.105788], "title": "Parking Lot A" },
                { "loc": [35.353139, -119.104546], "title": "Parking Lot B" },
                { "loc": [35.352196, -119.104562], "title": "Parking Lot C" },
                { "loc": [35.351894, -119.103087], "title": "Parking Lot D" },
                { "loc": [35.349893, -119.109071], "title": "Parking Lot E" },
                { "loc": [35.349847, -119.105935], "title": "Parking Lot F" },
                { "loc": [35.348674, -119.105761], "title": "Parking Lot G" },
                { "loc": [35.346458, -119.104230], "title": "Parking Lot H" },
                { "loc": [35.346165, -119.102387], "title": "Parking Lot I" },
                { "loc": [35.353130, -119.100432], "title": "Parking Lot J" },
                { "loc": [35.351477, -119.100437], "title": "Parking Lot K1" },
                { "loc": [35.350707, -119.099359], "title": "Parking Lot K2" },
                { "loc": [35.351297, -119.099745], "title": "Parking Lot K3" },
                { "loc": [35.350711, -119.097739], "title": "Parking Lot L" },
                { "loc": [35.351006, -119.104683], "title": "Performing Arts" },
                { "loc": [35.348237, -119.102671], "title": "Physical Education" },
                { "loc": [35.349716, -119.104664], "title": "Romberg Nursing Center" },
                { "loc": [35.350805, -119.102247], "title": "Runner Cafe" },
                { "loc": [35.349674, -119.103771], "title": "Science 1" },
                { "loc": [35.349643, -119.103221], "title": "Science 2" },
                { "loc": [35.349059, -119.103715], "title": "Science 3" },
                { "loc": [35.347847, -119.103808], "title": "Student Health Services" },
                { "loc": [35.348954, -119.101529], "title": "Student Recreation Center" },
                { "loc": [35.350208, -119.104967], "title": "Student Services" },
                { "loc": [35.349926, -119.101495], "title": "Student Union" },
                { "loc": [35.348799, -119.102714], "title": "Testing Room" },
                { "loc": [35.350378, -119.106340], "title": "University Advancement" },
                { "loc": [35.348810, -119.102947], "title": "University Police" },
                { "loc": [35.351527, -119.107325], "title": "Visual Arts" },
                { "loc": [35.351444, -119.103216], "title": "Walter Stiern Library" },
                { "loc": [35.344627, -119.103830], "title": "Well Core Repository" },
            ];

            var map = L.map('map').setView([35.348601, -119.103359], 18);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                
            }).addTo(map);

            var markersLayer = new L.LayerGroup();	//layer contain searched elements

            map.addLayer(markersLayer);


            map.locate({ setView: true, maxZoom: 16 });


            //---------get user location every three seconds
            var current_position, current_accuracy, destination;
            var flag = 0;

            var routing = L.Routing.control({
                waypoints: [ null
                    //L.latLng(current_position.getLatLng()),
                    //L.latLng(destination),
                ],
                show: false
            }).addTo(map);
            

            function onLocationFound(e) {
                // if position defined, then remove the existing position marker and accuracy circle from the map
                if (current_position) {
                    map.removeLayer(current_position);
                    map.removeLayer(current_accuracy);
                }
                
                var radius = e.accuracy / 2;

                current_position = L.marker(e.latlng).addTo(map);

                current_accuracy = L.circle(e.latlng, radius).addTo(map);

                routing.spliceWaypoints(0, 1, current_position.getLatLng());
                routing.spliceWaypoints(1, 1, destination);
            }


            function onLocationError(e) {
                alert(e.message);
            }

            map.on('locationfound', onLocationFound);
            map.on('locationerror', onLocationError);

            // map.locate({setView: true, maxZoom: 16, watch: true});
            // wrap map.locate in a function    
            function locate() {
                map.locate({ setView: false });
            }

            // call locate every 3 seconds... forever
            setInterval(locate, 3000);
            //-----------end user location

            var legend = L.control({ position: 'topright' });
            legend.onAdd = function (map) {
                var div = L.DomUtil.create('div', 'info legend');
                div.innerHTML = '<select onchange="selectDestination(this.value);">' +
                    '<option value="dest">Destination</option>' +
                    '<option value="Administration">Administration</option>' +
                    '<option value="Administration East">Administration East</option>' +
                    '<option value="Administration West">Administration West</option>' +
                    '<option value="Amphitheatre">Amphitheatre</option>' +
                    '<option value="Business Development Center A">Business Development Center A</option>' +
                    '<option value="Business Development Center B">Business Development Center B</option>' +
                    '<option value="Business Development Center C">Business Development Center C</option>' +
                    '<option value="Business Development Center D">Business Development Center D</option>' +
                    '<option value="Business Development Center E">Business Development Center E</option>' +
                    '<option value="Central Plant Operations">Central Plant Operations</option>' +
                    '<option value="Child Care">Child Care</option>' +
                    '<option value="Classroom Building">Classroom Building</option>' +
                    '<option value="Dore Theatre">Dore Theatre</option>' +
                    '<option value="Dorothy Donahoe Hall">Dorothy Donahoe Hall</option>' +
                    '<option value="Education Building">Education Building</option>' +
                    '<option value="Engineering Modulars">Engineering Modulars</option>' +
                    '<option value="Facilities">Facilities</option>' +
                    '<option value="Humanities Complex">Humanities Complex</option>' +
                    '<option value="Icardo Center">Icardo Center</option>' +
                    '<option value="J. Antonio Sports Center">J. Antonio Sports Center</option>' +
                    '<option value="J.R. Hillman Aquatic Center">J.R. Hillman Aquatic Center</option>' +
                    '<option value="Modular East 3">Modular East 3</option>' +
                    '<option value="Modular West">Modular West</option>' +
                    '<option value="Music Building">Music Building</option>' +
                    '<option value="Parking Lot A">Parking Lot A</option>' +
                    '<option value="Parking Lot B">Parking Lot B</option>' +
                    '<option value="Parking Lot C">Parking Lot C</option>' +
                    '<option value="Parking Lot D">Parking Lot D</option>' +
                    '<option value="Parking Lot E">Parking Lot E</option>' +
                    '<option value="Parking Lot F">Parking Lot F</option>' +
                    '<option value="Parking Lot G">Parking Lot G</option>' +
                    '<option value="Parking Lot H">Parking Lot H</option>' +
                    '<option value="Parking Lot I">Parking Lot I</option>' +
                    '<option value="Parking Lot J">Parking Lot J</option>' +
                    '<option value="Parking Lot K1">Parking Lot K1</option>' +
                    '<option value="Parking Lot K2">Parking Lot K2</option>' +
                    '<option value="Parking Lot K3">Parking Lot K3</option>' +
                    '<option value="Parking Lot L">Parking Lot L</option>' +
                    '<option value="Performing Arts">Performing Arts</option>' +
                    '<option value="Physical Education">Physical Education</option>' +
                    '<option value="Romberg Nursing Center">Romberg Nursing Center</option>' +
                    '<option value="Runner Cafe">Runner Cafe</option>' +
                    '<option value="Science 1">Science 1</option>' +
                    '<option value="Science 2">Science 2</option>' +
                    '<option value="Science 3">Science 3</option>' +
                    '<option value="Student Health Services">Student Health Services</option>' +
                    '<option value="Student Recreation Center">Student Recreation Center</option>' +
                    '<option value="Student Services">Student Services</option>' +
                    '<option value="Student Union">Student Union</option>' +
                    '<option value="Testing Room">Testing Room</option>' +
                    '<option value="University Advancement">University Advancement</option>' +
                    '<option value="University Police">University Police</option>' +
                    '<option value="Visual Arts">Visual Arts</option>' +
                    '<option value="Walter Stiern Library">Walter Stiern Library</option>' +
                    '<option value="Well Core Repository">Well Core Repository</option>' +
                    '</select>';
                div.firstChild.onmousedown = div.firstChild.ondblclick = L.DomEvent.stopPropagation;
                return div;
            };
            legend.addTo(map);

            function selectDestination(e) {
                switch (e) {
                    case "Administration":
                        destination = data[0].loc;
                        break;

                    case "Administration East":
                        destination = data[1].loc;
                        break;

                    case "Administration West":
                        destination = data[2].loc;
                        break;

                    case "Amphitheatre":
                        destination = data[3].loc;
                        break;

                    case "Business Development Center A":
                        destination = data[4].loc;
                        break;

                    case "Business Development Center B":
                        destination = data[5].loc;
                        break;

                    case "Business Development Center C":
                        destination = data[6].loc;
                        break;

                    case "Business Development Center D":
                        destination = data[7].loc;
                        break;

                    case "Business Development Center E":
                        destination = data[8].loc;
                        break;

                    case "Central Plant Operations":
                        destination = data[9].loc;
                        break;

                    case "Child Care":
                        destination = data[10].loc;
                        break;

                    case "Classroom Building":
                        destination = data[11].loc;
                        break;

                    case "Dore Theatre":
                        destination = data[12].loc;
                        break;

                    case "Dorothy Donahoe Hall":
                        destination = data[13].loc;
                        break;

                    case "Education Building":
                        destination = data[14].loc;
                        break;

                    case "Engineering Modulars":
                        destination = data[15].loc;
                        break;

                    case "Facilities":
                        destination = data[16].loc;
                        break;

                    case "Humanities Complex":
                        destination = data[17].loc;
                        break;

                    case "Icardo Center":
                        destination = data[18].loc;
                        break;

                    case "J. Antonio Sports Center":
                        destination = data[19].loc;
                        break;

                    case "J.R. Hillman Aquatic Center":
                        destination = data[20].loc;
                        break;

                    case "Modular East 3":
                        destination = data[21].loc;
                        break;

                    case "Modular West":
                        destination = data[22].loc;
                        break;

                    case "Music Building":
                        destination = data[23].loc;
                        break;

                    case "Parking Lot A":
                        destination = data[24].loc;
                        break;

                    case "Parking Lot B":
                        destination = data[25].loc;
                        break;

                    case "Parking Lot C":
                        destination = data[26].loc;
                        break;

                    case "Parking Lot D":
                        destination = data[27].loc;
                        break;

                    case "Parking Lot E":
                        destination = data[28].loc;
                        break;

                    case "Parking Lot F":
                        destination = data[29].loc;
                        break;

                    case "Parking Lot G":
                        destination = data[30].loc;
                        break;

                    case "Parking Lot H":
                        destination = data[31].loc;
                        break;

                    case "Parking Lot I":
                        destination = data[32].loc;
                        break;

                    case "Parking Lot J":
                        destination = data[33].loc;
                        break;

                    case "Parking Lot K1":
                        destination = data[34].loc;
                        break;

                    case "Parking Lot K2":
                        destination = data[35].loc;
                        break;

                    case "Parking Lot K3":
                        destination = data[36].loc;
                        break;

                    case "Parking Lot L":
                        destination = data[37].loc;
                        break;

                    case "Performing Arts":
                        destination = data[38].loc;
                        break;

                    case "Physical Education":
                        destination = data[39].loc;
                        break;

                    case "Romberg Nursing Center":
                        destination = data[40].loc;
                        break;

                    case "Runner Cafe":
                        destination = data[41].loc;
                        break;

                    case "Science 1":
                        destination = data[42].loc;
                        break;

                    case "Science 2":
                        destination = data[43].loc;
                        break;

                    case "Science 3":
                        destination = data[44].loc;
                        break;

                    case "Student Health Services":
                        destination = data[45].loc;
                        break;

                    case "Student Recreation Center":
                        destination = data[46].loc;
                        break;

                    case "Student Services":
                        destination = data[47].loc;
                        break;

                    case "Student Union":
                        destination = data[48].loc;
                        break;

                    case "Testing Room":
                        destination = data[49].loc;
                        break;

                    case "University Advancement":
                        destination = data[50].loc;
                        break;

                    case "University Police":
                        destination = data[51].loc;
                        break;

                    case "Visual Arts":
                        destination = data[52].loc;
                        break;

                    case "Walter Stiern Library":
                        destination = data[53].loc;
                        break;

                    case "Well Core Repository":
                        destination = data[54].loc;
                        break;

                    case "Destination":
                        break;
                }
            }

           
            


            
        </script>
</body>

</html>
